<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Get Your Location</title>
</head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        var form = document.createElement("form");
        form.id = "location_form";
        form.setAttribute('method', "get");
        form.setAttribute('action', "#");

        var lat = document.createElement("input");
        lat.type = "hidden";
        lat.name = "lat";
        lat.id = "lat";

        var lng = document.createElement("input");
        lng.type = "hidden";
        lng.name = "lng";
        lng.id = "lng";

        var subBut = document.createElement("input");
        subBut.type = "submit";
        subBut.name = "subBut";
        subBut.id = "subBut";

        var style = document.createElement('style');
          style.innerHTML = `
          #subBut {
          display: none;
          }
          `;
        document.head.appendChild(style);

        var error = document.createElement("p");
        error.id = "errorMessage";


        form.append(lat);
        form.append(lng);
        form.append(subBut);

        $("body").append(form, error);

        var positionOptions = {
            timeout: Infinity,
            maximumAge: 0,
            enableHighAccuracy: true
        };

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(showPosition, showError, positionOptions);
            } else {
                error.innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position) {
            lat.value = position.coords.latitude.toString();
            lng.value = position.coords.longitude.toString();
        }

        function showError(e) {
            switch (e.code) {
                case error.PERMISSION_DENIED:
                    error.innerHTML = "User denied the request for Geolocation.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    error.innerHTML = "Location information is unavailable.";
                    break;
                case error.TIMEOUT:
                    error.innerHTML = "The request to get user location timed out.";
                    break;
                default:
                    error.innerHTML = "An unknown error occurred.";
            }
        }

        function autoSubmit() {
            $("#subBut").click();
        }

        $('#location_form').submit(function(e) {
            e.preventDefault();
            console.log('sent');
            $.get($(this).attr('action'), {
                lat: lat.value,
                lng: lng.value
            });
         });

        getLocation();
        setInterval(autoSubmit, 10000);
    </script>
</body>
</html>